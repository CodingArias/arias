<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC	"-//mybatis.org//DTD Mapper 3.0//EN" 
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kedu.arias.MemberMapper" >
	
	<insert id="regMember">
		INSERT INTO member(MEMBER_ID
						 , MEMBER_FIRST_NAME
						 , MEMBER_LAST_NAME
						 , COUNTRY_ID
						 , MEMBER_IMG
						 , MEMBER_EMAIL
						 , MEMBER_PHONE
						 , MEMBER_PWD
						 , MEMBER_BIRTHDAY
						 , MEMBER_REG_DATE) 
		VALUES(#{MEMBER_ID}
			 , #{MEMBER_FIRST_NAME}
			 , #{MEMBER_LAST_NAME}
			 , #{COUNTRY_ID}
			 , #{MEMBER_IMG}
			 , #{MEMBER_EMAIL}
			 , #{MEMBER_PHONE}
			 , #{MEMBER_PWD}
			 , #{MEMBER_BIRTHDAY}
			 , #{MEMBER_REG_DATE})
	</insert>
	
	<select id="readMember" resultType="MemberDto">
		select MEMBER_ID
			 , MEMBER_FIRST_NAME
			 , MEMBER_LAST_NAME
			 , COUNTRY_ID
			 , MEMBER_IMG
			 , MEMBER_EMAIL
			 , MEMBER_PHONE
			 , MEMBER_PWD
			 , MEMBER_BIRTHDAY
			 , MEMBER_REG_DATE
		from member
		where member_id = #{member_id}
	</select>
	
	<update id="updateMember">
		UPDATE member 
		SET   country_id = #{country_id}
			, member_img = #{member_img}
    		, member_email = #{member_email}
    		, member_phone = #{member_phone}
    		, member_pwd = #{member_pwd}
		WHERE member_id = #{member_id};
	</update>
	
	<delete id="deleteMember">
		DELETE FROM member
		WHERE member_id = #{member_id};
	</delete>
	
	<select id="listAllMember" resultType="MemberDto">
		select member_id
			 , member_first_name
			 , member_last_name
			 , country_id
			 , member_img
			 , member_email
			 , member_phone
			 , member_birthday
			 , member_reg_date
		from member
		order by member_id desc
	</select>
	
	<sql id="search">
		<if test="searchType != null">
			<if test="searchType == 'searchCtr'.toString()">
				and country_name like CONCAT('%', #{keyword}, '%')
			</if>
		</if>
	</sql>
	
	<select id="SearchCountry" resultType="MemberDto">
		select * 
		from country_code
		where 1=1
		<include refid="search"></include>
		order by country_id desc
		limit #{pageStart}, #{perPageNum}
	</select>
	
	<select id="listSearchCountry" resultType="int">
		select count(country_id)
		from country_code
		where 1=1
		<include refid="search"></include>
	</select>
</mapper>